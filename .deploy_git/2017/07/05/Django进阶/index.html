<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Django进阶 | i@m</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="/css/normalize.min.css"><link rel="stylesheet" type="text/css" href="/css/pure-min.css"><link rel="stylesheet" type="text/css" href="/css/grids-responsive-min.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><script type="text/javascript" src="/js/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Django进阶</h1><a id="logo" href="/.">i@m</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Django进阶</h1><div class="post-meta">Jul 5, 2017<span> | </span><span class="category"><a href="/categories/Python/">Python</a></span><script src="/js/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><div class="post-content"><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">一、Form</div><div class="line"></div><div class="line">django中的Form一般有两种功能：1、输入html　　2、验证用户输入</div><div class="line"></div><div class="line">1、输入html</div><div class="line"></div><div class="line">from django.shortcuts import render</div><div class="line">from django import forms</div><div class="line"></div><div class="line">class UserForm(forms.Form):</div><div class="line">    host = forms.CharField()</div><div class="line">    port = forms.CharField()</div><div class="line">    email = forms.EmailField()</div><div class="line">    mobile = forms.CharField()</div><div class="line"></div><div class="line"></div><div class="line">def user_list(request):</div><div class="line">    obj = UserForm()</div><div class="line">    return render(request,&quot;index.html&quot;,&#123;&quot;obj&quot;:obj&#125;)</div><div class="line">html</div><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html lang=&quot;en&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">    &lt;title&gt;Title&lt;/title&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">    &lt;form action=&quot;/app01/user_list/&quot;&gt;</div><div class="line">        &lt;!--自动生成input标签--&gt;</div><div class="line">        &lt;p&gt;主机：&#123;&#123; obj.host &#125;&#125;&lt;/p&gt;</div><div class="line">        &lt;p&gt;端口：&#123;&#123; obj.port &#125;&#125;&lt;/p&gt;</div><div class="line">        &lt;p&gt;邮箱：&#123;&#123; obj.email &#125;&#125;&lt;/p&gt;</div><div class="line">        &lt;p&gt;手机：&#123;&#123; obj.mobile &#125;&#125;&lt;/p&gt;</div><div class="line">        &lt;input type=&quot;submit&quot;&gt;</div><div class="line">    &lt;/form&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">2、验证</div><div class="line">from django.shortcuts import render</div><div class="line">from django import forms</div><div class="line"></div><div class="line">class UserForm(forms.Form):</div><div class="line">    host = forms.CharField()</div><div class="line">    port = forms.CharField()</div><div class="line">    email = forms.EmailField()</div><div class="line">    mobile = forms.CharField()</div><div class="line"></div><div class="line">def user_list(request):</div><div class="line">    obj = UserForm()</div><div class="line">    if request.method == &quot;POST&quot;:</div><div class="line">        user_input_obj = UserForm(request.POST)#把提交过来的数据封装到UserForm，UserForm会自动把数据封装到user_input_obj</div><div class="line">        if user_input_obj.is_valid():   #验证用户输入是否合法</div><div class="line">            data = user_input_obj.clean()   #合法，获取数据</div><div class="line">        else:</div><div class="line">            error_msg = user_input_obj.errors   #不合法，返回错误信息</div><div class="line">            return render(request,&quot;index.html&quot;,&#123;&quot;obj&quot;:user_input_obj,&quot;error&quot;:error_msg&#125;)</div><div class="line">    return render(request,&quot;index.html&quot;,&#123;&quot;obj&quot;:obj&#125;)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">优化</div><div class="line">def user_list(request):</div><div class="line">    obj = UserForm(request.POST)#如果有数据，把提交过来的数据封装到UserForm，UserForm会自动把数据封装到user_input_obj</div><div class="line">    if request.method == &quot;POST&quot;:</div><div class="line">        if obj.is_valid():   #验证用户输入是否合法</div><div class="line">            data = obj.clean()   #合法，获取数据</div><div class="line">        else:</div><div class="line">            error_msg = obj.errors.as_data()   #不合法，返回错误信息</div><div class="line">            return render(request,&quot;index.html&quot;,&#123;&quot;obj&quot;:obj,&quot;error&quot;:error_msg&#125;)</div><div class="line">    return render(request,&quot;index.html&quot;,&#123;&quot;obj&quot;:obj,&#125;)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">html</div><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html lang=&quot;en&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">    &lt;title&gt;Title&lt;/title&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">    &lt;form action=&quot;/app01/user_list/&quot; method=&quot;post&quot;&gt;</div><div class="line">        &lt;!--自动生成input标签--&gt;</div><div class="line">        &lt;p&gt;主机：&#123;&#123; obj.host &#125;&#125;&lt;span&gt;&#123;&#123; error.host &#125;&#125;&lt;/span&gt;&lt;/p&gt;</div><div class="line">        &lt;p&gt;端口：&#123;&#123; obj.port &#125;&#125;&lt;span&gt;&#123;&#123; error.port &#125;&#125;&lt;/span&gt;&lt;/p&gt;</div><div class="line">        &lt;p&gt;邮箱：&#123;&#123; obj.email &#125;&#125;&lt;span&gt;&#123;&#123; error.email &#125;&#125;&lt;/span&gt;&lt;/p&gt;</div><div class="line">        &lt;p&gt;手机：&#123;&#123; obj.mobile &#125;&#125;&lt;span&gt;&#123;&#123; error.mobile &#125;&#125;&lt;/span&gt;&lt;/p&gt;</div><div class="line">        &lt;input type=&quot;submit&quot;&gt;</div><div class="line">    &lt;/form&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">3、定制From表单</div><div class="line"></div><div class="line">（1）设置报错信息，添加属性样式</div><div class="line"></div><div class="line">class UserForm(forms.Form):</div><div class="line">    host = forms.CharField(error_messages=&#123;&quot;required&quot;:&quot;主机不能为空&quot;&#125;,#设置显示的错误信息</div><div class="line">                           widget=forms.TextInput(attrs=&#123;&quot;class&quot;:&quot;form-control&quot;,</div><div class="line">                                                         &quot;placeholder&quot;: &quot;主机&quot;&#125;)#添加属性和样式</div><div class="line">                           )</div><div class="line">    port = forms.CharField()</div><div class="line">    email = forms.EmailField()</div><div class="line">    mobile = forms.CharField()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">（2）多行文本框</div><div class="line">#多行文本框，备注</div><div class="line">    memo = forms.CharField(required=False,  #可以为空</div><div class="line">                           widget=forms.Textarea(attrs=&#123;&quot;class&quot;:&quot;form-control&quot;,</div><div class="line">                                                         &quot;placeholder&quot;: &quot;备注&quot;&#125;)#添加属性和样式</div><div class="line">                           )</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">（3）下拉框</div><div class="line">#下拉框</div><div class="line">    user_type_choice=(</div><div class="line">        (0,&quot;普通用户&quot;),</div><div class="line">        (1,&quot;高级用户&quot;)</div><div class="line">    )</div><div class="line">    user_type = forms.IntegerField(widget=forms.widgets.Select(choices=user_type_choice,</div><div class="line">                                                                  attrs=&#123;&apos;class&apos;: &quot;form-control&quot;&#125;))</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">（4）动态生成select标签</div><div class="line"></div><div class="line">文件中取数据</div><div class="line"></div><div class="line">#动态下拉框</div><div class="line">　　 u_type = forms.IntegerField(widget=forms.widgets.Select( attrs=&#123;&apos;class&apos;: &quot;form-control&quot;&#125;))</div><div class="line"></div><div class="line">    def __init__(self, *args, **kwargs):</div><div class="line">        super(UserForm, self).__init__(*args, **kwargs)</div><div class="line">        import json</div><div class="line">        f=open(&quot;u_type_db&quot;)</div><div class="line">        data = f.read()</div><div class="line">        data_tuple = json.loads(data)</div><div class="line">        self.fields[&apos;u_type&apos;].widget.choices = data_tuple</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#u_type_db</div><div class="line">[[0, &quot;AAA&quot;], [1, &quot;BBB&quot;],[2,&quot;CCC&quot;]]</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">数据库中取数据</div><div class="line">def __init__(self, *args, **kwargs):</div><div class="line">    super(UserForm, self).__init__(*args, **kwargs)</div><div class="line">    data_tuple=models.UserInfo.objects.all().values_list(&apos;id&apos;,&apos;username&apos;)</div><div class="line">    self.fields[&apos;u_type&apos;].widget.choices = data_tuple</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">（5）自定义验证条件</div><div class="line">#自定义验证</div><div class="line">def mobile_validate(value):</div><div class="line">    mobile_re = re.compile(r&apos;^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]&#123;8&#125;$&apos;)</div><div class="line">    if not mobile_re.match(value):</div><div class="line">        raise ValidationError(&apos;手机号码格式错误&apos;)</div><div class="line"></div><div class="line"></div><div class="line">class UserForm(forms.Form):</div><div class="line">    mobile = forms.CharField(validators=[mobile_validate, ])#添加自定义手机号验证</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">4、漂亮显示错误信息</div><div class="line">def user_list(request):</div><div class="line">    obj = UserForm()</div><div class="line">    if request.method == &quot;POST&quot;:</div><div class="line">        user_input_obj = UserForm(request.POST)#把提交过来的数据封装到UserForm，UserForm会自动把数据封装到user_input_obj</div><div class="line">        if user_input_obj.is_valid():   #验证用户输入是否合法</div><div class="line">            data = user_input_obj.clean()   #合法，获取数据</div><div class="line">        else:</div><div class="line">            error_msg = user_input_obj.errors   #不合法，返回错误信息</div><div class="line">            return render(request,&quot;index.html&quot;,&#123;&quot;obj&quot;:user_input_obj,&quot;error&quot;:error_msg&#125;)</div><div class="line">    return render(request,&quot;index.html&quot;,&#123;&quot;obj&quot;:obj,&#125;)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">默认显示ul样式as_ul()，不美观</div><div class="line">error_msg = user_input_obj.errors   #不合法，返回错误信息</div></pre></td></tr></table></figure>
<p><img src="http://images2015.cnblogs.com/blog/866760/201605/866760-20160520002229263-1869926807.png" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">改成as_data()后只显示一个字符串格式</div><div class="line">error_msg = user_input_obj.errors.as_data()   #不合法，返回错误信息</div></pre></td></tr></table></figure>
<p><img src="http://images2015.cnblogs.com/blog/866760/201605/866760-20160520002305873-2024949274.png" alt="img"></p>
<p>方法：</p>
<p>　　定义</p>
<p><img src="http://images2015.cnblogs.com/blog/866760/201605/866760-20160520002635669-893647495.png" alt="img"></p>
<p>　　</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">在html顶部调用</div><div class="line">&#123;% load  form_tag %&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">引用</div><div class="line">&lt;p&gt;主机：&#123;&#123; obj.host &#125;&#125;&lt;span&gt;&#123;% error_message error.host %&#125;&lt;/span&gt;&lt;/p&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">as_json()　　用于ajax返回</div><div class="line">error_msg = user_input_obj.errors.as_json()#不合法，返回错误信息</div><div class="line">return HttpResponse(error_msg )</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">实例：</div><div class="line"></div><div class="line">html</div><div class="line"></div><div class="line">&#123;% load  form_tag %&#125;</div><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html lang=&quot;en&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">    &lt;title&gt;Title&lt;/title&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">    &lt;form action=&quot;/app01/user_list/&quot; method=&quot;post&quot;&gt;</div><div class="line">        &lt;!--自动生成input标签,也可以自己写html标签--&gt;</div><div class="line">        &lt;p&gt;主机：&#123;&#123; obj.host &#125;&#125;&lt;span&gt;&#123;% error_message error.host %&#125;&lt;/span&gt;&lt;/p&gt;&lt;!--引用--&gt;</div><div class="line">        &lt;p&gt;端口：&#123;&#123; obj.port &#125;&#125;&lt;span&gt;&#123;&#123; error.port &#125;&#125;&lt;/span&gt;&lt;/p&gt;</div><div class="line">        &lt;p&gt;邮箱：&#123;&#123; obj.email &#125;&#125;&lt;span&gt;&#123;&#123; error.email &#125;&#125;&lt;/span&gt;&lt;/p&gt;</div><div class="line">        &lt;p&gt;手机：&#123;&#123; obj.mobile &#125;&#125;&lt;span&gt;&#123;&#123; error.mobile &#125;&#125;&lt;/span&gt;&lt;/p&gt;</div><div class="line">        &lt;p&gt;备注：&#123;&#123; obj.memo &#125;&#125;&lt;span&gt;&#123;&#123; error.memo &#125;&#125;&lt;/span&gt;&lt;/p&gt;</div><div class="line">        &lt;p&gt;用户类型：&#123;&#123; obj.user_type &#125;&#125;&lt;span&gt;&#123;&#123; error.user_type &#125;&#125;&lt;/span&gt;&lt;/p&gt;</div><div class="line">        &lt;input type=&quot;submit&quot;&gt;</div><div class="line">    &lt;/form&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">views</div><div class="line">from django.shortcuts import render</div><div class="line">from django import forms</div><div class="line">import re</div><div class="line">from django.core.exceptions import ValidationError</div><div class="line"></div><div class="line">#自定义验证</div><div class="line">def mobile_validate(value):</div><div class="line">    mobile_re = re.compile(r&apos;^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]&#123;8&#125;$&apos;)</div><div class="line">    if not mobile_re.match(value):</div><div class="line">        raise ValidationError(&apos;手机号码格式错误&apos;)</div><div class="line"></div><div class="line">class UserForm(forms.Form):</div><div class="line">    host = forms.CharField(error_messages=&#123;&quot;required&quot;:&quot;主机不能为空&quot;&#125;,#设置显示的错误信息</div><div class="line">                           widget=forms.TextInput(attrs=&#123;&quot;class&quot;:&quot;form-control&quot;,</div><div class="line">                                                         &quot;placeholder&quot;: &quot;主机&quot;&#125;)#添加属性和样式</div><div class="line">                           )</div><div class="line">    port = forms.CharField(error_messages=&#123;&quot;required&quot;:&quot;端口不能为空&quot;&#125;)</div><div class="line">    email = forms.EmailField(error_messages=&#123;&quot;required&quot;:&quot;邮箱不能为空&quot;&#125;)</div><div class="line">    mobile = forms.CharField(error_messages=&#123;&quot;required&quot;:&quot;手机不能为空&quot;&#125;,</div><div class="line">                             validators=[mobile_validate, ])#添加自定义验证</div><div class="line"></div><div class="line">    #多行文本框，备注</div><div class="line">    memo = forms.CharField(required=False,  #可以为空</div><div class="line">                           widget=forms.Textarea(attrs=&#123;&quot;class&quot;:&quot;form-control&quot;,</div><div class="line">                                                         &quot;placeholder&quot;: &quot;备注&quot;&#125;)#添加属性和样式</div><div class="line">                           )</div><div class="line">    #下拉框</div><div class="line">    user_type_choice=(</div><div class="line">        (0,&quot;普通用户&quot;),</div><div class="line">        (1,&quot;高级用户&quot;)</div><div class="line">    )</div><div class="line">    user_type = forms.IntegerField(widget=forms.widgets.Select(choices=user_type_choice,</div><div class="line">                                                                  attrs=&#123;&apos;class&apos;: &quot;form-control&quot;&#125;))</div><div class="line"></div><div class="line">def user_list(request):</div><div class="line">    obj = UserForm()</div><div class="line">    if request.method == &quot;POST&quot;:</div><div class="line">        user_input_obj = UserForm(request.POST)#把提交过来的数据封装到UserForm，UserForm会自动把数据封装到user_input_obj</div><div class="line">        if user_input_obj.is_valid():   #验证用户输入是否合法</div><div class="line">            data = user_input_obj.clean()   #合法，获取数据</div><div class="line">        else:</div><div class="line">            error_msg = user_input_obj.errors.as_data()   #不合法，返回错误信息</div><div class="line">            return render(request,&quot;index.html&quot;,&#123;&quot;obj&quot;:user_input_obj,&quot;error&quot;:error_msg&#125;)</div><div class="line">    return render(request,&quot;index.html&quot;,&#123;&quot;obj&quot;:obj,&#125;)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">二、中间件</div><div class="line"></div><div class="line">1、django 中的中间件（middleware），其实就是一个类，在请求到来和结束后，django会根据自己的规则在合适的时机执行中间件中相应的方法settings模块中，有一个 MIDDLEWARE_CLASSES 变量，其中每一个元素就是一个中间件</div><div class="line"></div><div class="line">MIDDLEWARE_CLASSES = [</div><div class="line">    #&apos;django.middleware.security.SecurityMiddleware&apos;,</div><div class="line">    &apos;django.contrib.sessions.middleware.SessionMiddleware&apos;,</div><div class="line">    &apos;django.middleware.common.CommonMiddleware&apos;,</div><div class="line">    #&apos;django.middleware.csrf.CsrfViewMiddleware&apos;,</div><div class="line">    &apos;django.contrib.auth.middleware.AuthenticationMiddleware&apos;,</div><div class="line">    &apos;django.contrib.auth.middleware.SessionAuthenticationMiddleware&apos;,</div><div class="line">    &apos;django.contrib.messages.middleware.MessageMiddleware&apos;,</div><div class="line">    &apos;django.middleware.clickjacking.XFrameOptionsMiddleware&apos;,</div><div class="line">]</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">中间件中可以定义四个方法，分别是：</div><div class="line">process_request(self,request)</div><div class="line"></div><div class="line">process_view(self, request, callback, callback_args, callback_kwargs)</div><div class="line"></div><div class="line">process_exception(self, request, exception)</div><div class="line"></div><div class="line">process_response(self, request, response)</div><div class="line"></div><div class="line">每一个请求都是先通过中间件中的 process_request 函数，这个函数返回 None 或者 HttpResponse 对象，如果返回None ，继续处理其它中间件，如果返回一个 HttpResponse，就处理中止，返回到网页上Django 会从 MIDDLEWARE_CLASSES 中按照从上到下的顺序一个个执行中间件中的 process_request 函数，而其中 process_response 函数则是最前面的最后执行。</div><div class="line"></div><div class="line">2、自定义中间件</div><div class="line"></div><div class="line">创建中间件</div></pre></td></tr></table></figure>
<p><img src="http://images2015.cnblogs.com/blog/866760/201605/866760-20160523060909569-1729536887.png" alt="img"> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">class RequestMiddleware(object):</div><div class="line">    def process_request(self,request):</div><div class="line">        print(&quot;process_request&quot;)</div><div class="line">    def process_view(self, request, callback, callback_args, callback_kwargs):</div><div class="line">        print(&quot;process_view&quot;)</div><div class="line">    def process_exception(self, request, exception):</div><div class="line">        print(&quot;process_exception&quot;)</div><div class="line">    def process_response(self, request, response):</div><div class="line">        print(&quot;process_response&quot;)</div><div class="line">        return response</div><div class="line"></div><div class="line">class RequestMiddleware2(object):</div><div class="line">    def process_request(self,request):</div><div class="line">        print(&quot;process_request2&quot;)</div><div class="line">    def process_view(self, request, callback, callback_args, callback_kwargs):</div><div class="line">        print(&quot;process_view2&quot;)</div><div class="line">    def process_exception(self, request, exception):</div><div class="line">        print(&quot;process_exception2&quot;)</div><div class="line">    def process_response(self, request, response):</div><div class="line">        print(&quot;process_response2&quot;)</div><div class="line">        return response</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">注册中间件</div><div class="line"></div><div class="line">settings.py</div><div class="line"></div><div class="line">MIDDLEWARE_CLASSES = [</div><div class="line">    #&apos;django.middleware.security.SecurityMiddleware&apos;,</div><div class="line">    &apos;django.contrib.sessions.middleware.SessionMiddleware&apos;,</div><div class="line">    &apos;django.middleware.common.CommonMiddleware&apos;,</div><div class="line">    #&apos;django.middleware.csrf.CsrfViewMiddleware&apos;,</div><div class="line">    &apos;django.contrib.auth.middleware.AuthenticationMiddleware&apos;,</div><div class="line">    &apos;django.contrib.auth.middleware.SessionAuthenticationMiddleware&apos;,</div><div class="line">    &apos;django.contrib.messages.middleware.MessageMiddleware&apos;,</div><div class="line">    &apos;django.middleware.clickjacking.XFrameOptionsMiddleware&apos;,</div><div class="line">    &apos;app01.middleware.middle.RequestMiddleware&apos;,</div><div class="line">    &apos;app01.middleware.middle.RequestMiddleware2&apos;,</div><div class="line">]</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">路由执行的函数</div><div class="line">def index(request):</div><div class="line">    print(&quot;index&quot;)</div><div class="line">    return HttpResponse(&quot;index&quot;)</div></pre></td></tr></table></figure>
<p>执行结果</p>
<p><img src="http://images2015.cnblogs.com/blog/866760/201605/866760-20160523061422100-90183468.png" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">上面是中间没有HttpResponse返回时的执行流程顺序，先执行process_request和process_view方法，在执行路由定义的函数，最后从最后一个process_response 开始执行，process_exception只会在出现异常时执行</div><div class="line"></div><div class="line">三、缓存</div><div class="line"></div><div class="line">1、由于Django是动态网站，一般来说需要实时地生成访问的网页，展示给访问者，这样，内容可以随时变化，但是从数据库读多次把所需要的数据取出来，要比从内存或者硬盘等一次读出来 付出的成本大很多。最简单解决方式是使用：缓存，缓存将一个某个views的返回值保存至内存或者Redis中，一定时间内再有人来访问时，则不再去执行view中的操作，而是直接从内存或者Redis中之前缓存的内容拿到，并返回。</div><div class="line"></div><div class="line"> settings配置</div><div class="line"></div><div class="line">CACHES = &#123;</div><div class="line">    &apos;default&apos;: &#123;</div><div class="line">        &apos;BACKEND&apos;: &apos;django.core.cache.backends.filebased.FileBasedCache&apos;,#表示利用文件系统缓存</div><div class="line">        &apos;LOCATION&apos;: os.path.join(BASE_DIR, &apos;cache&apos;),#文件路径</div><div class="line">        &apos;TIMEOUT&apos;: 600,</div><div class="line">        &apos;OPTIONS&apos;: &#123;</div><div class="line">            &apos;MAX_ENTRIES&apos;: 1000</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">views</div><div class="line">import time</div><div class="line">from django.shortcuts import HttpResponse,render</div><div class="line">from django.views.decorators.cache import cache_page</div><div class="line"></div><div class="line">@cache_page(60 * 15)#表示缓存15分钟</div><div class="line">def index(request):</div><div class="line">    data=time.time()</div><div class="line">    return HttpResponse(data)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">其它的一些内建可用的 Backends</div><div class="line">&apos;django.core.cache.backends.db.DatabaseCache&apos;</div><div class="line">&apos;django.core.cache.backends.dummy.DummyCache&apos;</div><div class="line">&apos;django.core.cache.backends.filebased.FileBasedCache&apos;</div><div class="line">&apos;django.core.cache.backends.locmem.LocMemCache&apos;</div><div class="line">&apos;django.core.cache.backends.memcached.MemcachedCache&apos;</div><div class="line">&apos;django.core.cache.backends.memcached.PyLibMCCache&apos;</div><div class="line">更多相关：http://djangobook.py3k.cn/2.0/chapter15/</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">四、Session和Cookie</div><div class="line">cookie保存在客户端的电脑上，session保存与服务器</div><div class="line"></div><div class="line">session用来在服务器端保存用户会话状态信息，依赖于cookies</div><div class="line"></div><div class="line">操作session：</div><div class="line"></div><div class="line">　　获取　　session：request.session[key]</div><div class="line"></div><div class="line">　　设置　　session：reqeust.session[key] = value</div><div class="line"></div><div class="line">　　删除　　session：del request[key]</div><div class="line"></div><div class="line">request.session.set_expiry(value)</div><div class="line"></div><div class="line">tips:</div><div class="line">value是个整数，session会在些秒数后失效。</div><div class="line"></div><div class="line">value是个datatime或timedelta，session就会在这个时间后失效。</div><div class="line"></div><div class="line">value是0,用户关闭浏览器session就会失效。</div><div class="line"></div><div class="line">value是None,session会依赖全局session失效策略。</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">登录认证实例：</div><div class="line">&lt;form class=&quot;common_form&quot; id=&quot;Form&quot; method=&quot;post&quot; action=&quot;/app01/login/&quot;&gt;</div><div class="line">    &lt;div&gt;&lt;h1 class=&quot;login_title&quot;&gt;登录&lt;/h1&gt;&lt;/div&gt;</div><div class="line">    &lt;div style=&quot;width: 600px&quot;&gt;</div><div class="line">        &lt;div class=&quot;form_group&quot;&gt;&lt;input name=&quot;username&quot; class=&quot;form-control&quot; label=&apos;用户名&apos; type=&quot;text&quot; placeholder=&quot;用户名&quot; require=&apos;true&apos;&gt;&lt;/div&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">    &lt;div style=&quot;width: 600px&quot;&gt;</div><div class="line">        &lt;div class=&quot;form_group&quot;&gt;&lt;input name=&quot;password&quot; class=&quot;form-control&quot; label=&apos;密码&apos; type=&quot;password&quot; placeholder=&quot;密码&quot; require=&apos;true&apos;&gt;&lt;/div&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">    &lt;div class=&quot;form_group&quot;&gt;&lt;input class=&quot;btn btn-info form_btn&quot; type=&quot;submit&quot; value=&quot;登录&quot;&gt;&lt;/div&gt;</div><div class="line">&lt;/form&gt;</div><div class="line"></div><div class="line">html</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">def login(request):</div><div class="line">    if request.method == &quot;POST&quot;:</div><div class="line">        username = request.POST.get(&quot;username&quot;)</div><div class="line">        password = request.POST.get(&quot;password&quot;)</div><div class="line">        if username == &quot;zhangsan&quot; and password == &quot;123456&quot;:</div><div class="line">            request.session[&quot;IS_LOGIN&quot;] = True  #创建session</div><div class="line">            return redirect(&quot;/app01/home/&quot;)</div><div class="line">    return render(request,&quot;app01/login.html&quot;)</div><div class="line"></div><div class="line">def home(request):</div><div class="line">    islogin = request.session.get(&quot;IS_LOGIN&quot;,False)</div><div class="line">    if islogin:#如果用户已登录</div><div class="line">        return render(request,&quot;app01/menus.html&quot;)</div><div class="line">    else:</div><div class="line">        return redirect(&quot;/app01/login/&quot;)</div><div class="line"></div><div class="line">def logout(request):#退出</div><div class="line">    try:</div><div class="line">        del request.session[&apos;IS_LOGIN&apos;]</div><div class="line">    except KeyError:</div><div class="line">        pass</div><div class="line">    return redirect(&quot;/app01/login/&quot;)</div><div class="line"></div><div class="line">views</div><div class="line"></div><div class="line">更多：http://docs.30c.org/djangobook2/chapter14/</div><div class="line"></div><div class="line">　　　https://docs.djangoproject.com/en/1.9/ref/settings/#settings-sessions</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">五、Ajax</div><div class="line"></div><div class="line">1、跨站请求伪造</div><div class="line"></div><div class="line">django为用户实现防止跨站请求伪造的功能，通过中间件 django.middleware.csrf.CsrfViewMiddleware 来完成</div><div class="line"></div><div class="line">GET 请求不需要 CSRF 认证，POST 请求需要正确认证才能得到正确的返回结果。一般在POST请求的表单中加入｛% csrf_token %&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;form id=&quot;Form&quot; method=&quot;post&quot; action=&quot;/app01/login/&quot;&gt;</div><div class="line">    ｛% csrf_token %&#125;</div><div class="line">    &lt;input name=&apos;username&apos;  type=&quot;text&quot;&gt;</div><div class="line">    &lt;input name=&apos;password&apos;  type=&quot;password&quot;&gt;</div><div class="line">    &lt;input type=&quot;submit&quot; value=&quot;登录&quot;&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure>
<p><code>veiw中设置返回值：</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">return render_to_response(&quot;app01/login.html&quot;,data,context_instance=RequestContext(request))　　</div><div class="line">#或者</div><div class="line">return render(request, &quot;app01/login.html&quot;, data)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">2、发送简单数据</div><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html lang=&quot;en&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">    &lt;title&gt;Title&lt;/title&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">    &lt;input type=&quot;button&quot; onclick=&quot;Ajaxsubmit();&quot; value=&quot;提交&quot;/&gt;</div><div class="line"></div><div class="line">    &lt;script type=&quot;text/javascript&quot; src=&quot;../../static/style/js/jquery-2.2.3.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script&gt;</div><div class="line">        function Ajaxsubmit()&#123;</div><div class="line">            var host = &apos;127.0.0.1&apos;;</div><div class="line">            var port = &apos;8000&apos;;</div><div class="line">            $.ajax(&#123;</div><div class="line">                url:&quot;/app01/user_list/&quot;,</div><div class="line">                type:&apos;POST&apos;,</div><div class="line">                data:&#123;h:host,p:port&#125;,</div><div class="line">                success:function(arg)&#123;</div><div class="line">                &#125;</div><div class="line">            &#125;)</div><div class="line">        &#125;</div><div class="line">    &lt;/script&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">2、发送复杂数据类型</div><div class="line"></div><div class="line">html</div><div class="line"></div><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html lang=&quot;en&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">    &lt;title&gt;Title&lt;/title&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">    &lt;input type=&quot;button&quot; onclick=&quot;Ajaxsubmit();&quot; value=&quot;提交&quot;/&gt;</div><div class="line"></div><div class="line">    &lt;script type=&quot;text/javascript&quot; src=&quot;../../static/style/js/jquery-2.2.3.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script&gt;</div><div class="line">        function Ajaxsubmit()&#123;</div><div class="line">             var userlist = [</div><div class="line">                &#123;&apos;username&apos;:&apos;zhangsan&apos;,&apos;arg&apos;:18&#125;,</div><div class="line">                &#123;&apos;username&apos;:&apos;lisi&apos;,&apos;arg&apos;:20&#125;,</div><div class="line">            ];</div><div class="line">            $.ajax(&#123;</div><div class="line">                url:&quot;/app01/user_list/&quot;,</div><div class="line">                type:&apos;POST&apos;,</div><div class="line">                tradition: true,</div><div class="line">                data:&#123;data:JSON.stringify(userlist)&#125;,//序列化</div><div class="line">                success:function(arg)&#123;</div><div class="line">                     var callback_dict = $.parseJSON(arg);//这里把字符串转换为对象</div><div class="line">                    //然后咱们就可以判断</div><div class="line">                    if(callback_dict.status)&#123;//如果为True执行失败</div><div class="line">                        alert(&apos;提交成功&apos;)</div><div class="line">                    &#125;else&#123;//如果为False执行失败</div><div class="line">                        alert(callback_dict.error)</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">        &#125;</div><div class="line">    &lt;/script&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">views</div><div class="line">def user_list(request):</div><div class="line">    ret = &#123;&apos;status&apos;:True,&apos;error&apos;:&apos;&apos;&#125;</div><div class="line">    try:</div><div class="line">        print request.POST</div><div class="line">    except Exception,e:</div><div class="line">        ret[&apos;status&apos;] = False   #如果出错就把ret[status] = False</div><div class="line">        ret[&apos;error&apos;] = str(e)</div><div class="line">    return HttpResponse(json.dumps(ret))    #返回ret字典</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">六、静态文件引用优化</div><div class="line"></div><div class="line">在写项目时会导入很多静态文件，而有时要修改静态文件的目录名时就比较麻烦</div><div class="line"></div><div class="line">原来导入方式</div><div class="line"></div><div class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;/static/style/js/jquery-2.2.3.js&quot;&gt;&lt;/script&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">优化 	在settings的TEMPLATES里添加　　&apos;django.core.context_processors.static&apos;</div><div class="line">TEMPLATES = [</div><div class="line">    &#123;</div><div class="line">        &apos;BACKEND&apos;: &apos;django.template.backends.django.DjangoTemplates&apos;,</div><div class="line">        &apos;DIRS&apos;: [os.path.join(BASE_DIR,&apos;templates&apos;),],</div><div class="line">        &apos;APP_DIRS&apos;: True,</div><div class="line">        &apos;OPTIONS&apos;: &#123;</div><div class="line">            &apos;context_processors&apos;: [</div><div class="line">                &apos;django.template.context_processors.debug&apos;,</div><div class="line">                &apos;django.template.context_processors.request&apos;,</div><div class="line">                &apos;django.contrib.auth.context_processors.auth&apos;,</div><div class="line">                &apos;django.contrib.messages.context_processors.messages&apos;,</div><div class="line">                &apos;django.core.context_processors.static&apos;,</div><div class="line">            ],</div><div class="line">        &#125;,</div><div class="line">    &#125;,</div><div class="line">]</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">优化后导入</div><div class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;&#123;&#123; STATIC_URL &#125;&#125;style/js/jquery-2.2.3.js&quot;&gt;&lt;/script&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">这样要修改目录的话只需在配置文件里修改 STATIC_URL就可以了</div><div class="line"></div><div class="line">七、上传文件</div><div class="line"></div><div class="line">html</div><div class="line"></div><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html lang=&quot;en&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">    &lt;title&gt;Title&lt;/title&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">    &lt;form action=&quot;/app01/upload/&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</div><div class="line">        &lt;p&gt;&lt;input type=&quot;text&quot; name=&quot;hostname&quot;&gt;&lt;/p&gt;</div><div class="line">        &lt;p&gt;&lt;input type=&quot;file&quot; name=&quot;file_name_1&quot;&gt;&lt;/p&gt;</div><div class="line">        &lt;input type=&quot;submit&quot; value=&quot;上传&quot;&gt;</div><div class="line">    &lt;/form&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">views</div><div class="line">#upload</div><div class="line">def upload(request):</div><div class="line">    if request.method == &quot;POST&quot;:</div><div class="line">        file_name=request.FILES</div><div class="line">        file_obj=file_name.get(&quot;file_name_1&quot;) #获取到封装了文件操作的对象</div><div class="line">        f = open(file_obj.name,&quot;wb&quot;)</div><div class="line">        for line in file_obj.chunks(): #循环取数据</div><div class="line">            f.write(line)   #写入</div><div class="line">        f.close()</div><div class="line">        return HttpResponse(&quot;ok&quot;)</div><div class="line">    else:</div><div class="line">        return render(request,&quot;app01/uploadfile.html&quot;)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">一、ORM操作进阶</div><div class="line"></div><div class="line">ForeignKey关联</div><div class="line"></div><div class="line">示例models</div><div class="line"></div><div class="line">from django.db import models</div><div class="line"># Create your models here.</div><div class="line">class User(models.Model):</div><div class="line">    name = models.CharField(max_length=32)</div><div class="line"></div><div class="line">class Host(models.Model):</div><div class="line">    host_name = models.CharField(max_length=32)</div><div class="line">    blong_to = models.ForeignKey(&quot;User&quot;)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ForeignKey创建数据</div><div class="line">models.Host.objects.create(host_name=&quot;127.0.0.1&quot;,blong_to=models.User.objects.get(id=1))</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">1、搜索条件使用 __ 连接　　2、获取值时使用 . 连接</div><div class="line">user_list=models.Host.objects.filter(blong_to__name=&quot;lisi&quot;)    #一对多过滤条件</div><div class="line"></div><div class="line">for item in user_list:</div><div class="line">    print(item.host_name,item.blong_to.name)  #取数据，在前端取数据也类似</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ForeignKey修改数据</div><div class="line">hosts=models.Host.objects.get(host_name=&quot;127.0.0.1&quot;)</div><div class="line">users=models.User.objects.get(id=2)</div><div class="line"></div><div class="line">hosts.blong_to=users</div><div class="line">hosts.save()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">反向关联查询</div><div class="line">user_obj=models.User.objects.get(id=2)</div><div class="line">print(user_obj.host_set.select_related())</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">ManyToManyField关联</div><div class="line"></div><div class="line">示例models</div><div class="line"></div><div class="line">class UserInfo(models.Model):</div><div class="line">    name = models.CharField(max_length=32)</div><div class="line">    email = models.CharField(max_length=32)</div><div class="line">    address = models.CharField(max_length=128)</div><div class="line"></div><div class="line"></div><div class="line">class UserGroup(models.Model):</div><div class="line">    caption = models.CharField(max_length=64)</div><div class="line">    user_info = models.ManyToManyField(&apos;UserInfo&apos;)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">ManyToManyField操作（_set是多对多中的固定搭配）</div><div class="line">user_info_obj = models.UserInfo.objects.get(name=&quot;zhangsan&quot;)</div><div class="line">    user_info_objs = models.UserInfo.objects.all()</div><div class="line"></div><div class="line">    group_obj = models.UserGroup.objects.get(caption=&apos;CEO&apos;)</div><div class="line">    group_objs = models.UserGroup.objects.all()</div><div class="line"></div><div class="line">    # 添加数据</div><div class="line">    #group_obj.user_info.add(user_info_obj)</div><div class="line">    #group_obj.user_info.add(*user_info_objs)</div><div class="line">    #</div><div class="line">    #user_info_obj.usergroup_set.add(group_obj)</div><div class="line">    #user_info_obj.usergroup_set.add(*group_objs)</div><div class="line"></div><div class="line">    # 删除数据</div><div class="line">    #group_obj.user_info.remove(user_info_obj)</div><div class="line">    #group_obj.user_info.remove(*user_info_objs)</div><div class="line">    #</div><div class="line">    #user_info_obj.usergroup_set.remove(group_obj)</div><div class="line">    #user_info_obj.usergroup_set.remove(*group_objs)</div><div class="line"></div><div class="line">    # 获取数据</div><div class="line">    #print group_obj.user_info.all()</div><div class="line">    #print group_obj.user_info.all().filter(id=1)</div><div class="line">    #</div><div class="line">    #print user_info_obj.usergroup_set.all()</div><div class="line">    #print user_info_obj.usergroup_set.all().filter(caption=&apos;CEO&apos;)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">F 对同一表内不同的字段进行对比查询</div><div class="line">class Entry(models.Model):</div><div class="line">    n_comments = models.IntegerField()</div><div class="line">    n_pingbacks = models.IntegerField()</div><div class="line">    rating = models.IntegerField()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">from django.db.models import F</div><div class="line">models.Entry.objects.filter(n_comments__gt=F(&apos;n_pingbacks&apos;))</div><div class="line">models.Entry.objects.filter(n_comments__gt=F(&apos;n_pingbacks&apos;) * 2)</div><div class="line">models.Entry.objects.filter(rating__lt=F(&apos;n_comments&apos;) + F(&apos;n_pingbacks&apos;))</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">批量自增</div><div class="line">models.Entry.objects.all().update(n_pingbacks=F(&apos;n_pingbacks&apos;) + 1)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Q  构建搜索条件</div><div class="line">from django.db.models import Q</div><div class="line"></div><div class="line">models.UserInfo.objects.get(</div><div class="line">    Q(name=&apos;zhangsan&apos;),Q(email=&quot;12345678@qq.com&quot;))  #两个都要满足</div><div class="line">models.UserInfo.objects.get(</div><div class="line">    Q(name=&apos;zhangsan&apos;) | Q(email=&quot;12345678@qq.com&quot;))  #只需满足一个</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">models.UserInfo.objects.get(</div><div class="line">    Q(name=&apos;zhangsan&apos;),Q(email=&quot;12345678@qq.com&quot;) | Q(address=&quot;abcde&quot;))</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">二、django 实现分页</div><div class="line"></div><div class="line">实例</div><div class="line"></div><div class="line">#!/usr/bin/env python</div><div class="line"># -*- coding:utf-8 -*-</div><div class="line">from django.shortcuts import render,HttpResponse</div><div class="line">from django.core.paginator import Paginator, EmptyPage, PageNotAnInteger</div><div class="line">from app01 import models</div><div class="line"># Create your views here.</div><div class="line">def stu_login(request):</div><div class="line">    return render(request,&quot;app01/login.html&quot;)</div><div class="line"></div><div class="line"></div><div class="line">def stu_home(request):</div><div class="line">    customer_list=models.Customer.objects.all()</div><div class="line">    paginator = Paginator(customer_list, 1) #每页显示条数</div><div class="line"></div><div class="line">    page = request.GET.get(&apos;page&apos;)</div><div class="line">    try:</div><div class="line">        contacts = paginator.page(page)</div><div class="line">    except PageNotAnInteger:</div><div class="line">        # If page is not an integer, deliver first page.</div><div class="line">        contacts = paginator.page(1)</div><div class="line">    except EmptyPage:</div><div class="line">        # If page is out of range (e.g. 9999), deliver last page of results.</div><div class="line">        contacts = paginator.page(paginator.num_pages)</div><div class="line"></div><div class="line">    return render(request, &quot;app01/home.html&quot;, &#123;&quot;customer_list&quot;:contacts&#125;)</div><div class="line"></div><div class="line">views</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&lt;div class=&quot;pagination&quot;&gt;</div><div class="line">        &lt;nav&gt;</div><div class="line">            &lt;ul class=&quot;pagination&quot;&gt;</div><div class="line">                &#123;% if customer_list.has_previous %&#125;</div><div class="line">                    &lt;li class=&quot;&quot;&gt;&lt;a href=&quot;?page=&#123;&#123; customer_list.previous_page_number &#125;&#125;&quot; aria-label=&quot;Previous&quot;&gt;&lt;span aria-hidden=&quot;true&quot;&gt;&amp;laquo;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;</div><div class="line">                &#123;% endif %&#125;</div><div class="line">                &#123;% for page_num in customer_list.paginator.page_range %&#125;</div><div class="line">                    &#123;% if page_num == customer_list.number %&#125;&lt;!--如果page_num是当前选中的页--&gt;</div><div class="line">                      &lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;?page=&#123;&#123; page_num &#125;&#125;&quot;&gt;&#123;&#123; page_num &#125;&#125; &lt;span class=&quot;sr-only&quot;&gt;(current)&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;</div><div class="line">                    &#123;% else %&#125;</div><div class="line">                      &lt;li class=&quot;&quot;&gt;&lt;a href=&quot;?page=&#123;&#123; page_num &#125;&#125;&quot;&gt;&#123;&#123; page_num &#125;&#125; &lt;span class=&quot;sr-only&quot;&gt;(current)&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;</div><div class="line">                    &#123;% endif %&#125;</div><div class="line">                &#123;% endfor %&#125;</div><div class="line">                &#123;% if customer_list.has_next %&#125;</div><div class="line">                    &lt;li class=&quot;&quot;&gt;&lt;a href=&quot;?page=&#123;&#123; customer_list.next_page_number &#125;&#125;&quot; aria-label=&quot;Next&quot;&gt;&lt;span aria-hidden=&quot;true&quot;&gt;&amp;raquo;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;</div><div class="line">                &#123;% endif %&#125;</div><div class="line">            &lt;/ul&gt;</div><div class="line">        &lt;/nav&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line"></div><div class="line">html</div><div class="line">优化：固定页码个数</div><div class="line"></div><div class="line">1、自定义template tags</div></pre></td></tr></table></figure>
<p>　　<img src="http://images2015.cnblogs.com/blog/866760/201606/866760-20160617112910338-1857700335.png" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">#!/usr/bin/env python</div><div class="line"># -*- coding:utf-8 -*-</div><div class="line">from django import template</div><div class="line">from django.utils.safestring import mark_safe</div><div class="line"></div><div class="line">register = template.Library()</div><div class="line"></div><div class="line">@register.simple_tag</div><div class="line">def custemer_paging(current_page,loop_num): #传入选中页和循环页</div><div class="line">    num_left=current_page-2</div><div class="line">    num_right=current_page+2</div><div class="line">    if loop_num&gt;num_left and loop_num&lt;num_right:#只显示3页</div><div class="line">        if current_page == loop_num:</div><div class="line">            result=&apos;&apos;&apos;&lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;?page=%s&quot;&gt;%s &lt;span class=&quot;sr-only&quot;&gt;(current)&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&apos;&apos;&apos;%(loop_num,loop_num)</div><div class="line">        else:</div><div class="line">            result=&apos;&apos;&apos;&lt;li class=&quot;&quot;&gt;&lt;a href=&quot;?page=%s&quot;&gt;%s &lt;span class=&quot;sr-only&quot;&gt;(current)&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&apos;&apos;&apos;%(loop_num,loop_num)</div><div class="line">        return mark_safe(result)</div><div class="line">    result=&quot;&quot;</div><div class="line">    return mark_safe(result)</div><div class="line"></div><div class="line">custemer_tags.py</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">在html开头导入</div><div class="line">&#123;% load custemer_tags %&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">使用自定义simple_tag</div><div class="line">&lt;div class=&quot;pagination&quot;&gt;</div><div class="line">        &lt;nav&gt;</div><div class="line">            &lt;ul class=&quot;pagination&quot;&gt;</div><div class="line">                &#123;% if customer_list.has_previous %&#125;</div><div class="line">                    &lt;li class=&quot;&quot;&gt;&lt;a href=&quot;?page=&#123;&#123; customer_list.previous_page_number &#125;&#125;&quot; aria-label=&quot;Previous&quot;&gt;&lt;span aria-hidden=&quot;true&quot;&gt;&amp;laquo;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;</div><div class="line">                &#123;% endif %&#125;</div><div class="line">                &#123;% for page_num in customer_list.paginator.page_range %&#125;</div><div class="line">                    </div><div class="line">                    &#123;% custemer_paging customer_list.number page_num %&#125;&lt;!--使用custemer_tags--&gt;</div><div class="line"></div><div class="line">                &#123;% endfor %&#125;</div><div class="line">                &#123;% if customer_list.has_next %&#125;</div><div class="line">                    &lt;li class=&quot;&quot;&gt;&lt;a href=&quot;?page=&#123;&#123; customer_list.next_page_number &#125;&#125;&quot; aria-label=&quot;Next&quot;&gt;&lt;span aria-hidden=&quot;true&quot;&gt;&amp;raquo;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;</div><div class="line">                &#123;% endif %&#125;</div><div class="line">            &lt;/ul&gt;</div><div class="line">        &lt;/nav&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">    更多详情：https://docs.djangoproject.com/en/1.9/topics/pagination/</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">三、在自己写的脚本里调用django models</div><div class="line">#!/usr/bin/env python</div><div class="line"># -*- coding:utf-8 -*-</div><div class="line">import os</div><div class="line">os.environ[&apos;DJANGO_SETTINGS_MODULE&apos;] = &apos;django_project.settings&apos;</div><div class="line">import django</div><div class="line">django.setup()</div><div class="line"></div><div class="line">from app01 import models</div><div class="line"></div><div class="line">result = models.UserInfo.objects.get(id=1)</div><div class="line">print(result)</div></pre></td></tr></table></figure>
<p><img src="http://images2015.cnblogs.com/blog/866760/201606/866760-20160607011542261-1111262964.png" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">四、用户认证</div><div class="line">from django.contrib.auth.models import User</div><div class="line"></div><div class="line">class UserProfile(models.Model):</div><div class="line">    user = models.OneToOneField(User)</div><div class="line">    name = models.CharField(max_length=32)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">from django.contrib.auth import authenticate,login,logout</div><div class="line">from django.contrib.auth.decorators import login_required</div><div class="line"></div><div class="line">@login_required</div><div class="line">def acc_home(request):</div><div class="line">    return render(request,&quot;index.html&quot;)</div><div class="line"></div><div class="line">def acc_login(request):</div><div class="line">    if request.method == &quot;POST&quot;:</div><div class="line">        username = request.POST.get(&quot;username&quot;)</div><div class="line">        password = request.POST.get(&quot;password&quot;)</div><div class="line">        user = authenticate(username=username,password=password) #验证</div><div class="line"></div><div class="line">        if user is not None:</div><div class="line">            login(request,user) #登录</div><div class="line">            return redirect(&quot;/app01/acc_home/&quot;)</div><div class="line">    else:</div><div class="line">        return render(request,&quot;login.html&quot;)</div><div class="line"></div><div class="line">def acc_logout(request):</div><div class="line">    logout(request) #退出</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">在前端显示用户名或对应的名字</div><div class="line">&lt;div&gt;</div><div class="line">        &#123;% if request.user.is_authenticated %&#125; &lt;!--如果已经登录--&gt;</div><div class="line">            &lt;span&gt;&#123;&#123; request.user &#125;&#125;&lt;/span&gt; &lt;!--用户名--&gt;</div><div class="line">            &lt;span&gt;&#123;&#123; request.user.userprofile.name &#125;&#125;&lt;/span&gt; &lt;!--用户名在UserProfile表对应的名字--&gt;</div><div class="line">        &#123;% endif %&#125;</div><div class="line">    &lt;/div&gt;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">五、权限管理</div><div class="line"></div><div class="line">django 自带有基本的权限管理 ，但粒度和限制权限的维度都只是针对具体的表</div><div class="line"></div><div class="line">自己写的权限要易扩展、灵活，权限系统的设计对开发者、用户要实现透明，即他们不需要改变自己原有的使用系统或调用接口的方式，权限要能实现非常小的粒度的控制，甚至细致到一个按键某个用户是否能按。</div><div class="line"></div><div class="line">想对一个功能实现权限控制，要做到只需在views方法上加一个装饰器就行了</div><div class="line"></div><div class="line">例：</div><div class="line"></div><div class="line">在表内创建一个class Meta，自己定义几个权限。</div><div class="line"></div><div class="line">class UserProfile(models.Model):</div><div class="line">    user = models.OneToOneField(User)</div><div class="line">    name = models.CharField(verbose_name=u&quot;姓名&quot;,max_length=32)</div><div class="line">    def __unicode__(self):</div><div class="line">        return self.name</div><div class="line">    class Meta:</div><div class="line">        permissions = ((&quot;view_customer_list&quot;,u&quot;查看客户信息&quot;),</div><div class="line">                       (&quot;view_customer_info&quot;,u&quot;查看客户详细信息&quot;),</div><div class="line">                       (&quot;view_customer_updata&quot;,u&quot;修改详细信息&quot;),</div><div class="line">                       )</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">python manage.py makemigrations</div><div class="line"></div><div class="line">python manage.py migrate</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line">关联动作</div><div class="line"></div><div class="line">这里创建一个permissions.py，创建check_permission装饰器</div><div class="line"></div><div class="line">#!/usr/bin/env python</div><div class="line"># -*- coding:utf-8 -*-</div><div class="line">from django.core.urlresolvers import resolve</div><div class="line">from django.shortcuts import render</div><div class="line">perm_dic = &#123;</div><div class="line">    &quot;view_customer_list&quot;:[&quot;customer_list&quot;,&quot;GET&quot;,[]],</div><div class="line">    &quot;view_customer_info&quot;:[&quot;customer_info&quot;,&quot;GET&quot;,[]],</div><div class="line">    &quot;view_customer_updata&quot;:[&quot;customer_info&quot;,&quot;POST&quot;,[]],</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">def perm_check(*args,**kwargs):</div><div class="line">     request = args[0]</div><div class="line">     url_resovle_obj = resolve(request.path_info)</div><div class="line">     current_url_namespace = url_resovle_obj.url_name</div><div class="line">     #app_name = url_resovle_obj.app_name #use this name later</div><div class="line">     print(&quot;url namespace:&quot;,current_url_namespace)</div><div class="line">     matched_flag = False # find matched perm item</div><div class="line">     matched_perm_key = None</div><div class="line">     if current_url_namespace is not None:#if didn&apos;t set the url namespace, permission doesn&apos;t work</div><div class="line">         print(&quot;find perm...&quot;)</div><div class="line">         for perm_key in perm_dic:</div><div class="line">             perm_val = perm_dic[perm_key]</div><div class="line">             if len(perm_val) == 3:#otherwise invalid perm data format</div><div class="line">                 url_namespace,request_method,request_args = perm_val</div><div class="line">                 print(url_namespace,current_url_namespace)</div><div class="line">                 if url_namespace == current_url_namespace: #matched the url</div><div class="line">                     if request.method == request_method:#matched request method</div><div class="line">                         if not request_args:#if empty , pass</div><div class="line">                             matched_flag = True</div><div class="line">                             matched_perm_key = perm_key</div><div class="line">                             print(&apos;mtched...&apos;)</div><div class="line">                             break #no need looking for  other perms</div><div class="line">                         else:</div><div class="line">                             for request_arg in request_args: #might has many args</div><div class="line">                                 request_method_func = getattr(request,request_method) #get or post mostly</div><div class="line">                                 #print(&quot;-----&gt;&gt;&gt;&quot;,request_method_func.get(request_arg))</div><div class="line">                                 if request_method_func.get(request_arg) is not None:</div><div class="line">                                     matched_flag = True # the arg in set in perm item must be provided in request data</div><div class="line">                                 else:</div><div class="line">                                     matched_flag = False</div><div class="line">                                     print(&quot;request arg [%s] not matched&quot; % request_arg)</div><div class="line">                                     break #no need go further</div><div class="line">                             if matched_flag == True: # means passed permission check ,no need check others</div><div class="line">                                 print(&quot;--passed permission check--&quot;)</div><div class="line">                                 matched_perm_key = perm_key</div><div class="line">                                 break</div><div class="line"></div><div class="line">     else:#permission doesn&apos;t work</div><div class="line">         return True</div><div class="line"></div><div class="line">     if matched_flag == True:</div><div class="line">         #pass permission check</div><div class="line">         perm_str = &quot;app01.%s&quot; %(matched_perm_key)</div><div class="line">         if request.user.has_perm(perm_str):</div><div class="line">             print(&quot;\033[42;1m--------passed permission check----\033[0m&quot;)</div><div class="line">             return True</div><div class="line">         else:</div><div class="line">             print(&quot;\033[41;1m ----- no permission ----\033[0m&quot;)</div><div class="line">             print(request.user,perm_str)</div><div class="line">             return False</div><div class="line">     else:</div><div class="line">         print(&quot;\033[41;1m ----- no matched permission  ----\033[0m&quot;)</div><div class="line"></div><div class="line">def check_permission(func):</div><div class="line">     def wrapper(*args,**kwargs):</div><div class="line">         print(&quot;---start check perms&quot;,args[0])</div><div class="line">         if not perm_check(*args,**kwargs):</div><div class="line">             return render(args[0],&apos;app01/403.html&apos;)</div><div class="line">         return func(*args,**kwargs)</div><div class="line">         #print(&quot;---done check perms&quot;)</div><div class="line">     return wrapper</div><div class="line"></div><div class="line">permissions.py</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">url(r&apos;^stu_home/$&apos;, views.stu_home,name=&quot;customer_list&quot;),</div><div class="line">   url(r&apos;^stu_detail/(\d+)/$&apos;, views.stu_detail,name=&quot;customer_info&quot;),</div><div class="line">在views导入自己写的装饰器并在相应方法上加一个装饰器</div></pre></td></tr></table></figure>
<p><img src="http://images2015.cnblogs.com/blog/866760/201606/866760-20160621160515459-76627028.png" alt="img"></p>
<p>可以用超级用户通过admin对普通用户进行权限控制</p>
<p><img src="http://images2015.cnblogs.com/blog/866760/201606/866760-20160621161752147-448652341.png" alt="img"></p>
<p><img src="http://images2015.cnblogs.com/blog/866760/201606/866760-20160621161759584-1551884284.png" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">六、CSRF（跨站域请求伪造）</div><div class="line"></div><div class="line">CSRF（Cross Site Request Forgery, 跨站域请求伪造）是一种网络的攻击方式，它在 2007 年曾被列为互联网 20 大安全隐患之一</div><div class="line"></div><div class="line">防御策略</div><div class="line"></div><div class="line">　　在请求地址中添加 token 并验证</div><div class="line"></div><div class="line">Django 中使用CSRF，在表单下使用&#123;% csrf_token %&#125;</div><div class="line"></div><div class="line">&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&#123;% csrf_token %&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">AJAX中CSRF</div><div class="line"></div><div class="line">function getCookie(name) &#123;</div><div class="line">    var cookieValue = null;</div><div class="line">    if (document.cookie &amp;&amp; document.cookie != &apos;&apos;) &#123;</div><div class="line">        var cookies = document.cookie.split(&apos;;&apos;);</div><div class="line">        for (var i = 0; i &lt; cookies.length; i++) &#123;</div><div class="line">            var cookie = jQuery.trim(cookies[i]);</div><div class="line">            // Does this cookie string begin with the name we want?</div><div class="line">            if (cookie.substring(0, name.length + 1) == (name + &apos;=&apos;)) &#123;</div><div class="line">                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));</div><div class="line">                break;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return cookieValue;</div><div class="line">&#125;</div><div class="line">var csrftoken = getCookie(&apos;csrftoken&apos;);</div><div class="line"></div><div class="line">function csrfSafeMethod(method) &#123;</div><div class="line">    // these HTTP methods do not require CSRF protection</div><div class="line">    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));</div><div class="line">&#125;</div><div class="line">$.ajaxSetup(&#123;</div><div class="line">    beforeSend: function(xhr, settings) &#123;</div><div class="line">        if (!csrfSafeMethod(settings.type) &amp;&amp; !this.crossDomain) &#123;</div><div class="line">            xhr.setRequestHeader(&quot;X-CSRFToken&quot;, csrftoken);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://mpengju.com/2017/07/05/Django进阶/" data-id="cj4qis78u001oxsvstwv5dr8p" class="article-share-link">分享</a><div class="tags"><a href="/tags/Python/">Python</a><a href="/tags/Django/">Django</a></div><div class="post-nav"><a href="/2017/07/05/Django基础/" class="pre">Django基础</a><a href="/2017/07/05/Arduino蜂鸣器播放生日快乐/" class="next">Arduino蜂鸣器播放生日快乐</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://mpengju.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Arduino/">Arduino</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tomcat/">Tomcat</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/fedora/">fedora</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/github/">github</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/html/">html</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/nodejs/">nodejs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/raspberry-pi/">raspberry pi</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/react/">react</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端/">前端</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/实验/">实验</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/树莓派/">树莓派</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/正则/">正则</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/移动端/">移动端</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/css/" style="font-size: 15px;">css</a> <a href="/tags/前端/" style="font-size: 15px;">前端</a> <a href="/tags/正则表达式/" style="font-size: 15px;">正则表达式</a> <a href="/tags/Arduino/" style="font-size: 15px;">Arduino</a> <a href="/tags/控制器/" style="font-size: 15px;">控制器</a> <a href="/tags/webview/" style="font-size: 15px;">webview</a> <a href="/tags/h5/" style="font-size: 15px;">h5</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/服务器/" style="font-size: 15px;">服务器</a> <a href="/tags/Django/" style="font-size: 15px;">Django</a> <a href="/tags/fedora/" style="font-size: 15px;">fedora</a> <a href="/tags/SSH/" style="font-size: 15px;">SSH</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/Flask/" style="font-size: 15px;">Flask</a> <a href="/tags/机器学习/" style="font-size: 15px;">机器学习</a> <a href="/tags/html/" style="font-size: 15px;">html</a> <a href="/tags/数据库/" style="font-size: 15px;">数据库</a> <a href="/tags/mongodb/" style="font-size: 15px;">mongodb</a> <a href="/tags/nodejs/" style="font-size: 15px;">nodejs</a> <a href="/tags/代码块/" style="font-size: 15px;">代码块</a> <a href="/tags/Tomcat/" style="font-size: 15px;">Tomcat</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/SASS/" style="font-size: 15px;">SASS</a> <a href="/tags/树莓派/" style="font-size: 15px;">树莓派</a> <a href="/tags/物联网/" style="font-size: 15px;">物联网</a> <a href="/tags/远程登录/" style="font-size: 15px;">远程登录</a> <a href="/tags/ajax/" style="font-size: 15px;">ajax</a> <a href="/tags/上传/" style="font-size: 15px;">上传</a> <a href="/tags/js/" style="font-size: 15px;">js</a> <a href="/tags/清理垃圾/" style="font-size: 15px;">清理垃圾</a> <a href="/tags/vlc/" style="font-size: 15px;">vlc</a> <a href="/tags/转换/" style="font-size: 15px;">转换</a> <a href="/tags/github/" style="font-size: 15px;">github</a> <a href="/tags/域名/" style="font-size: 15px;">域名</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/主题/" style="font-size: 15px;">主题</a> <a href="/tags/命令/" style="font-size: 15px;">命令</a> <a href="/tags/存储/" style="font-size: 15px;">存储</a> <a href="/tags/jquery/" style="font-size: 15px;">jquery</a> <a href="/tags/jQuery/" style="font-size: 15px;">jQuery</a> <a href="/tags/less/" style="font-size: 15px;">less</a> <a href="/tags/格式化/" style="font-size: 15px;">格式化</a> <a href="/tags/node/" style="font-size: 15px;">node</a> <a href="/tags/npm/" style="font-size: 15px;">npm</a> <a href="/tags/卸载/" style="font-size: 15px;">卸载</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/邮件/" style="font-size: 15px;">邮件</a> <a href="/tags/react/" style="font-size: 15px;">react</a> <a href="/tags/直流电机/" style="font-size: 15px;">直流电机</a> <a href="/tags/语音聊天/" style="font-size: 15px;">语音聊天</a> <a href="/tags/移动端/" style="font-size: 15px;">移动端</a> <a href="/tags/WEB/" style="font-size: 15px;">WEB</a> <a href="/tags/兼容性/" style="font-size: 15px;">兼容性</a> <a href="/tags/正则/" style="font-size: 15px;">正则</a> <a href="/tags/人脸识别/" style="font-size: 15px;">人脸识别</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/07/05/如何优雅的用Python玩转语音聊天机器人/">如何优雅的用Python玩转语音聊天机器人</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/05/移动web资源整理/">移动web资源整理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/05/深度学习写了个老板探测器/">深度学习写了个老板探测器</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/05/长按删除/">长按删除</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/05/移动web页面给用户发送邮件的方法/">移动端WEB给用户发送邮件</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/05/练习—计算器/">练习—计算器</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/05/用树莓派B+连接HC-sr04超声模块测距/">用树莓派B+连接HC-sr04超声模块测距</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/05/用JSJQUERY获取地址栏参数的方法/">用JS\JQUERY获取地址栏参数的方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/05/树莓派设备购置清单/">树莓派设备购置清单</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/05/树莓派设置支持中文/">树莓派设置支持中文</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://mpengju.com" title="i@m" target="_blank">i@m</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">i@m.</a> Powered by<a rel="nofollow" target="_blank"> Hexo.</a><a rel="nofollow" target="_blank"> Theme</a> by<a rel="nofollow" target="_blank" href="mailto:i@mpengju.com?subject=我是？&amp;body=很高兴认识你"> i@mpengju.com</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>